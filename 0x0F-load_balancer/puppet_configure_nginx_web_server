# Installs a Nginx server and configures HTTP response header 

exec { 'install nginx':
  provider => shell,
  command  => 'sudo apt-get -y update; sudo apt-get install nginx -y; echo "Hello World!" | 
	       sudo tee /var/www/html/index.nginx-debian.html ; 
               sudo sed -i "s/server_name _;/server_name _;\n\trewrite ^\/redirect_me https:\/\/github.com\/n1klaus permanent;/" /etc/nginx/sites-available/default ;
               sudo service nginx start',
}

exec { 'set header':
  provider => shell,
  command  => 'sudo sed -i "/^http*/a\\\tadd_header X-Served-By $HOSTNAME;\n" /etc/nginx/nginx.conf;
               sudo service nginx restart',
}
